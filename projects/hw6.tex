\documentclass[12pt]{article}
\setlength\parindent{0pt}
\usepackage{amsmath}
\usepackage{fullpage}
\setlength{\parskip}{4mm}
\def\LL{\left\langle}   % left angle bracket
\def\RR{\right\rangle}  % right angle bracket
\def\LP{\left(}         % left parenthesis
\def\RP{\right)}        % right parenthesis
\def\LB{\left\{}        % left curly bracket
\def\RB{\right\}}       % right curly bracket
\def\PAR#1#2{ {{\partial #1}\over{\partial #2}} }
\def\PARTWO#1#2{ {{\partial^2 #1}\over{\partial #2}^2} }
\def\PARTWOMIX#1#2#3{ {{\partial^2 #1}\over{\partial #2 \partial #3}} }
\newcommand{\BE}{\begin{displaymath}}
\newcommand{\EE}{\end{displaymath}}
\newcommand{\BNE}{\begin{equation}}
\newcommand{\ENE}{\end{equation}}
\newcommand{\BEA}{\begin{eqnarray}}
\newcommand{\EEA}{\nonumber\end{eqnarray}}
\newcommand{\EL}{\nonumber\\}
\newcommand{\la}[1]{\label{#1}}
\newcommand{\ie}{{\em i.e.\ }}
\newcommand{\eg}{{\em e.\,g.\ }}
\newcommand{\cf}{cf.\ }
\newcommand{\etc}{etc.\ }
\newcommand{\Tr}{{\rm tr}}
\newcommand{\etal}{{\it et al.}}
\newcommand{\OL}[1]{\overline{#1}\ } % overline
\newcommand{\OLL}[1]{\overline{\overline{#1}}\ } % double overline
\newcommand{\OON}{\frac{1}{N}} % "one over N"
\newcommand{\OOX}[1]{\frac{1}{#1}} % "one over X"

\begin{document}
\Large
\centerline{\sc{Physics 307 Homework 6}}
\centerline{Due date: see below}
\normalsize

This homework assignment comes in three parts.

Your first grade will come from you showing me or Prashant your progress in class by 6PM on Tuesday, 1 November.

Your second grade will involve a project submission before 11AM, 8 November.

Your final grade will involve a substantial report due 11AM, 15 November. The contents of this report will contain some wisdom about physics that even many physicists
do not know; you should ensure it is very well written (devoting perhaps several hours to its preparation).

{\bf Please start early.} This assignment is the crux of this class.
This will be a bit more challenging to code than your previous one; please don't put it off until a few days before it's due.

In this assignment, you will model a stretched string (as in a guitar or violin) using a lattice elasticity model, in which point masses (``nodes'') are connected by Hooke's-law springs.
For reference, the force law on any given node $i$ (given in more detail in class) is:

\begin{align}
  \dot v_{x_i} &= \frac{1}{m} \left[ k \hat r_{{i,i-1}_x} (r_{i,i-1} - r_0) + k \hat r_{i,i+1} (r_{i,i+1} - r_0) \right] \\
  \dot v_{y_i} &= \frac{1}{m} \left[ k \hat r_{{i,i-1}_y} (r_{i,i-1} - r_0) + k \hat r_{i,i+1} (r_{i,i+1} - r_0) \right]
\end{align}

where

$\vec r_{i,j}$ is a vector pointing from the $i$'th node to the $j$'th one, and is thus equal to $(x_j-x_i)\hat i + (y_j-y_i)\hat j$, $k$ is the spring constant of a single spring, $r_0$ is its unstretched length, and $m$ is the mass of each node.
As before, you can use the ``unit vector trick'' to write $\hat r_{i,j}$ in terms of the dynamical variables in the problem:

\begin{align}
  \hat r_{{i,j}_x} &= \frac{x_i - x_j}{\sqrt{(x_i-x_j)^2 + (y_i-y_j)^2}}\\
  \hat r_{{i,j}_y} &= \frac{y_i - y_j}{\sqrt{(x_i-x_j)^2 + (y_i-y_j)^2}}
\end{align}


  
  A lattice simulation of a stretched string has the following parameters:
    \begin{itemize}
      \item{The number of nodes in the simulation $N+1$ (or the number of strings $N$)}
        \item{The linear mass density of the unstretched string $\mu$}
        \item{The unstretched length of the string $L_0$}
        \item{The tension $T$ applied to it to stretch it, which gives you the stretched length $L$}
        \item{The stiffness $\alpha$ (Young's modulus times cross-sectional area)}
      \end{itemize}

\newpage

\begin{center}\large Checkpoint 1: Make it work (due 1 Nov)\end{center}

\begin{enumerate}

  \item{Determine values of $m$, $k$, and $r_0$ (the ``microscopic'' quantities of interest to your simulation) as a function of $N, \mu, L_0$ and $\alpha$ (the ``macroscopic'' quantities).}

  \item{Write a program that simulates the vibrations of a stretched string of uniform density and elasticity, as we will discuss in class. (Notes will be posted on the website, too.)
      You should be able to easily change (by setting variables) some crucial parameters of your simulation: $N, \mu, L_0$, and $\alpha$.

      You should use the leapfrog solver for your simulation.}

  \item{Determine the initial conditions (all of the $x_i$'s; all the $y$-coordinates and velocities will be zero) for a stretched but unexcited string with tension $T$ applied to it. You will first need to determine the stretched length $L'$, then put your $N$
    masses at equidistant points between $x=0$ and $x=L'$. Implement these initial conditions, and verify that the string doesn't move.} 

  \item{Now stretch your string with sufficient tension to stretch it to around 125\% of its unstretched length, and excite it somehow. You can do this by applying some external force to it at some instant in time, or by choosing initial values for the $y_i$'s.
    Verify that it moves somewhat realistically.}

  \item{Play around with your initial conditions, along with $N$, the stretch amount, $\mu$, $L$, and so on. Be prepared to discuss anything interesting you find with me..}

  \item{Modify your program to track conservation of energy (recall that the elastic potential energy in each spring is $U=\frac{1}{2}k(r-r_0)^2$) and verify that energy is approximately conserved.}

\end{enumerate}

\begin{center}\large Checkpoint 2: Ideal Behavior (due 8 Nov)\end{center}

\begin{enumerate}

\item Modify your initial conditions so that they correspond to a Gaussian ``bump''. In other words, your initial conditions will be $y(x) = A \exp \left( \frac{-(x-x_0)^2}{\sigma^2} \right).$

Play around with the values of $x_0$ and $\sigma$. How does the width of the bump correspond to the amount of energy in high normal modes vs. low normal modes?

\item If you have access to a real stringed instrument (guitar, violin, ukelele...), excite the string with both the fat part of your thumb and with your thumbnail. Does what you hear correspond to the answers
to the previous question?

\item{Modify your initial conditions so that they correspond to a {\it normal mode} of vibration, as discussed in class}
\item{Verify qualitatively that for small amplitudes your string behaves as expected. Discuss how you verified this and what you saw.}
\item Now modify your program so that the following parameters can be entered as command line parameters: (see the notes on this)

\begin{itemize}
\item The timestep $dt$
\item The number of springs $N$
\item The linear density $\mu$
\item The stiffness $\alpha$
\item The length $L$
\item The desired normal mode number $n$
\item (optional) The frameskip value
\end{itemize}

\item Modify your program so that it calculates (by observing the motion of the string) the period of oscillation. This is most easily done by choosing a mass located at an antinode
(mass number $N/(2n)$) and watching its velocity; when its velocity changes sign, you've completed a half-period. 

\item If we assume that the wave speed is $v=\sqrt{T/\mu}$ then we expect the period $\tau$ of any given normal mode to be

$$
\tau_{\rm theoretical} = \frac{2L'}{n} \sqrt{\frac{\mu'}{T}}
$$

Note that the mass density $\mu'$ that appears here is the one {\it after} the string is stretched, as discussed in class: $\mu' = \mu \frac{L}{L'}$.

For $N$ large enough, this should be independent of $N$. 

Verify that your predictions for the period are approximately correct using a small amplitude and different values of $\mu$, $T$, $L$, $n$, and $N$. 

\item All of these things are true only in the limit where you can ``trust'' the simulation -- i.e. where $N$ is large enough and $dt$ is small enough. How do the needed
values of $N$ and $dt$ depend on $n$ and $T$?

\end{enumerate}

\begin{center}\large Part 3: Departure from the Small-Amplitude Limit (due 17 Nov)\end{center}

All of the things you've learned about the vibrating string -- noninterfering superpositions of normal modes whose frequency is independent of amplitude -- relate to solutions of the ideal wave equation. But deriving this equation from our model requires making the small-angle approximation to trigonometric functions, and this is only valid in the limit $A \rightarrow 0$. Now it's time to do something the pen-and-paper crowd can't do (without a great deal of pain): get away from that limit.


\begin{enumerate}

\item Ensure you've finished all of Part 2 -- that is, that your string correctly reproduces the analytic period $\tau_{\rm theoretical} = \frac{2L'}{n} \sqrt{\frac{\mu'}{T}}$ for any values of $L$, $n$, $N$, and $T$ as long as the amplitude is small enough. If not, your results for everything following will be nonsensical.

\item Try running your simulation at higher amplitudes using a variety of initial conditions. Play with this for a while. 
Do you still see well-defined normal modes with a constant frequency that ``stay put''? Look carefully at the motion of each point; do they still move only up and down? Describe your observations.
Remember, in the low-amplitude limit (the stuff you can do with pen and paper), the different normal modes do not couple to each other: if you excite a string in the $n=1$ normal mode, 
the amplitudes of all other normal modes will be zero forever. Is this what you observe here at increasing amplitude? 

As the amplitude increases, does it even make sense to talk about ``the period'' as an unambiguously-defined thing?

Now, for the quantitative study of the nonlinear behavior. Define $\Delta(n,N,A)$ as the relative difference between the analytic period $\tau_{an} = \frac{2\pi}{n}\sqrt{\frac{\mu'}{T}}$ and the observed period, defined as $$\Delta(n,A) = \frac{\tau_{\rm {obs}}-\tau_{\rm{an}}}{\tau_{\rm{an}}}.$$ This will depend on the normal mode you're looking at, the number of segments $N$ and the amplitude. 

\item We expect $\Delta \rightarrow 0$ as $A \rightarrow 0$ and $N \rightarrow \infty$. For a very small amplitude and a sufficiently large $N$, verify that this is true.

All of your subsequent studies will examine the behavior of $\Delta$ as the amplitude grows and as the number of segments drops.



\item First, let's look at {\bf the effect of increasing amplitude.} Modify your program to print out $\Delta$ as it measures the period for a variety of different amplitudes. Just as for your integration codes at the beginning of the term, the best
way to do this is to wrap the entire thing in a {\tt for} loop over amplitude, set to increase the amplitude by a multiplicative factor each time. (For instance, you might write
{\tt for (amp=1e-5; amp<2; amp *= 1.5)} or similar.) 

Note that there are multiple sources of deviation from the theoretical period in your calculation:

\begin{itemize}
\item The effect of the amplitude (the thing we want to measure here)
\item The effect of finite $N$
\item The effect of finite timestep (unless you use the interpolation method discussed previously to refine your estimate of when $v_y=0$, you're unable to determine the period any
more precisely than one timestep
\end{itemize}

Thus you'll need to ensure that you are looking only at the variable you intend: if you're studying the effect of the amplitude, keep $N$ large enough and $dt$ small enough that they 
don't affect your results.


For a value of $N$ large enough that it doesn't affect anything (for instance, $N=200$), simulate the first normal mode at a variety of amplitudes. Plot $\Delta$ as a function of the 
amplitude on a log/log plot. Comment on the mathematical form of the dependence of the amplitude on the period. How does this compare with the ``conventional wisdom'' that the amplitude
does not affect the period at all?

Now do the same thing for the $n=4$ normal mode. Is $\Delta$ larger or smaller here? Note that at low amplitude the period of the $n=4$ mode should be precisely 1/4 that of the $n=1$ 
mode. Is this true as the amplitude increases? 

The bulk of your report should be concerned with this question: ``how does increasing the amplitude affect the behavior of the string?'' Write both about your quantitative observations
and what you notice qualitatively in the animation. 

\item Second, look at {\bf the effect of decreasing $N$.} At low amplitude, simulate both the $n=1$ and $n=5$ normal modes for values of $N$ ranging from 10 to 200. How does $\Delta$
depend on $N$? Comment on the need for high resolution in simulations: when can we get away with low-resolution simulations, and when do we need high resolution ones?


\end{enumerate}

\end{document}
